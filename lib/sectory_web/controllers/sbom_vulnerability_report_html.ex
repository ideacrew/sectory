defmodule SectoryWeb.SbomVulnerabilityReportHTML do
  use SectoryWeb, :html

  embed_templates "sbom_vulnerability_report_html/*"

  def critical_issues(analysis) do
    Enum.filter(analysis.vulnerabilities, fn(v) ->
      v.severity == "critical"
    end)
  end

  def high_issues(analysis) do
    Enum.filter(analysis.vulnerabilities, fn(v) ->
      v.severity == "high"
    end)
  end
end
