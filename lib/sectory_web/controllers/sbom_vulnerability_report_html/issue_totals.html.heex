<section class="major-section">
<h1>Issue Summary</h1>

<section>
<h2>Confirmed Issues</h2>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Critical</td>
<td><%= Map.get(@analysis.totals, {"critical", false}, 0) %></td>
</tr>
<tr>
<td>High</td>
<td><%= Map.get(@analysis.totals, {"high", false}, 0) %></td>
</tr>
<tr>
<td>Medium</td>
<td><%= Map.get(@analysis.totals, {"medium", false}, 0) %></td>
</tr>
<tr>
<td>Low</td>
<td><%= Map.get(@analysis.totals, {"low", false}, 0) %></td>
</tr>
<tr>
<td>Info</td>
<td><%= Map.get(@analysis.totals, {"info", false}, 0) %></td>
</tr>
<tr>
<td>Unknown</td>
<td><%= Map.get(@analysis.totals, {"unknown", false}, 0) %></td>
</tr>
<tr>
<td>None</td>
<td><%= Map.get(@analysis.totals, {"none", false}, 0) %></td>
</tr>
</tbody>
<tfoot>
<tr>
<td>Total</td>
<td><%= Enum.sum(Map.values(Map.filter(@analysis.totals, fn {k, _v} -> elem(k, 1) == false end))) %></td>
</tr>
</tfoot>
</table>
</section>

<section>
<h2>Potential Issues</h2>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Critical</td>
<td><%= Map.get(@analysis.totals, {"critical", true}, 0) %></td>
</tr>
<tr>
<td>High</td>
<td><%= Map.get(@analysis.totals, {"high", true}, 0) %></td>
</tr>
<tr>
<td>Medium</td>
<td><%= Map.get(@analysis.totals, {"medium", true}, 0) %></td>
</tr>
<tr>
<td>Low</td>
<td><%= Map.get(@analysis.totals, {"low", true}, 0) %></td>
</tr>
<tr>
<td>Info</td>
<td><%= Map.get(@analysis.totals, {"info", true}, 0) %></td>
</tr>
<tr>
<td>Unknown</td>
<td><%= Map.get(@analysis.totals, {"unknown", true}, 0) %></td>
</tr>
<tr>
<td>None</td>
<td><%= Map.get(@analysis.totals, {"none", true}, 0) %></td>
</tr>
</tbody>
<tfoot>
<tr>
<td>Total</td>
<td><%= Enum.sum(Map.values(Map.filter(@analysis.totals, fn {k, _v} -> elem(k, 1) end))) %></td>
</tr>
</tfoot>
</table>
</section>

<section>
<h2>All Issues</h2>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Critical</td>
<td><%= Map.get(@analysis.all_issue_totals, "critical", 0) %></td>
</tr>
<tr>
<td>High</td>
<td><%= Map.get(@analysis.all_issue_totals, "high", 0) %></td>
</tr>
<tr>
<td>Medium</td>
<td><%= Map.get(@analysis.all_issue_totals, "medium", 0) %></td>
</tr>
</tbody>
<tr>
<td>Low</td>
<td><%= Map.get(@analysis.all_issue_totals, "low", 0) %></td>
</tr>
<tr>
<td>Info</td>
<td><%= Map.get(@analysis.all_issue_totals, "info", 0) %></td>
</tr>
<tr>
<td>Unknown</td>
<td><%= Map.get(@analysis.all_issue_totals, "unknown", 0) %></td>
</tr>
<tr>
<td>None</td>
<td><%= Map.get(@analysis.all_issue_totals, "none", 0) %></td>
</tr>
<tfoot>
<tr>
<td>Total</td>
<td><%= Enum.sum(Map.values(@analysis.all_issue_totals)) %></td>
</tr>
</tfoot>
</table>
</section>
</section>