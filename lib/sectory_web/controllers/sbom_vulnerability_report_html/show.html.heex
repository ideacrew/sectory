<%= issue_totals %{analysis: @analysis} %>

<% critical_issue_set = critical_issues(@analysis) %>
<%= if Enum.count(critical_issue_set) > 0  do %>
  <section class="major-section">
  <h1>Critical Issues</h1>
  <%= for ci <- critical_issue_set do %>
    <%= vulnerability %{vulnerability: ci} %>
  <% end %>
  </section>
<% end %>

<% high_issue_set = high_issues(@analysis) %>
<%= if Enum.count(high_issue_set) > 0  do %>
  <section class="major-section">
  <h1>High Issues</h1>
  <%= for hi <- high_issue_set do %>
    <%= vulnerability %{vulnerability: hi} %>
  <% end %>
  </section>
<% end %>

<section>
<h1>Applicable Mitigation Statements</h1>
<%= if Enum.count(@analysis.mitigations) > 0 do %>
  <%= for ms <- @analysis.mitigations do %>
  <%= mitigation_statement %{mitigation: ms} %>
  <% end %>
<%= else %>
  <p>No mitigation statements provided.</p>
<% end %>
</section>