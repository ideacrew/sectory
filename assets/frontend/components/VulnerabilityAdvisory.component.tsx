import { Component, Fragment } from "react";
import * as CycloneModel from "../cyclonedx/models";
import React from "react";

type PropsType  = {
  vulnerability: CycloneModel.Vulnerability
}

export class VulnerabilityAdvisoryComponent extends Component<PropsType, any> {

  renderAdvisories(advisories: Array<CycloneModel.Advisory>) {
    return advisories.map((a,i) => {
        return(
          <li key={ "vuln-advisory-item-" + this.props.vulnerability["bom-ref"] + i}>
            {a.url}
          </li>
        );
    });
  }

  render() {
    if (this.props.vulnerability.advisories) {
      const advisories = this.props.vulnerability.advisories;
      if (advisories.length > 0) {
        return(
          <Fragment>
            <h3>Advisories</h3>
            <ol>
                {this.renderAdvisories(advisories)}
            </ol>
          </Fragment>
        );
      }
    }
    return "";
  }
}