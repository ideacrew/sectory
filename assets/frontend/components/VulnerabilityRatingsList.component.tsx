import { Component, ReactNode, Fragment } from "react";
import * as CycloneModel from "../cyclonedx/models";
import React from "react";

type PropsType  = {
  vulnerability: CycloneModel.Vulnerability
}

export class VulnerabilityRatingsListComponent extends Component<PropsType, any, any> {
  renderRatings(ratings: CycloneModel.Rating[]) {
    return ratings.map((r,i) => {
      return <tr key={ "vuln-ratings-row" + this.props.vulnerability["bom-ref"] + i}>
        <td>{r.severity}</td>
        <td>{r.score}</td>
        <td>{r.method}</td>
        <td>{r.vector}</td>
      </tr>
    })
  }

  render() : ReactNode | string {
    if (this.props.vulnerability.ratings) {
      const ratings = this.props.vulnerability.ratings;
      if (ratings.length > 0) {
        return(<Fragment>
          <h3>Ratings</h3>
          <table>
            <thead>
              <tr>
                <th>Severity</th>
                <th>Score</th>
                <th>Method</th>
                <th>Vector</th>
              </tr>
            </thead>
            <tbody>
              {this.renderRatings(ratings)}
            </tbody>
          </table>
        </Fragment>);
      }
    }
    return (
      ""
    );
  }
}